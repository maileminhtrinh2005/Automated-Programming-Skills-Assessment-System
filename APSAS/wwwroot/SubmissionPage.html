<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Code Submission</title>
</head>
<body>
    <h2>Online Judge - Submit Code</h2>

    <!-- Nhập code -->
    <label for="codeArea">Source Code:</label><br />
    <textarea id="codeArea" rows="15" cols="80"></textarea>
    <br /><br />

    <!-- Chọn ngôn ngữ -->
    <label for="languageSelect">Select Language:</label>
    <select id="languageSelect">
        <option value="71">Python (3.8.1)</option>
        <option value="62">Java (OpenJDK 13.0.1)</option>
        <option value="50">C (GCC 9.2.0)</option>
        <option value="54">C++ (GCC 9.2.0)</option>
        <option value="63">JavaScript (Node.js 12.14.0)</option>
        <option value="68">PHP (7.4.1)</option>
    </select>
    <br /><br />

    <!-- Nút submit -->
    <button onclick="submitCode()">Submit</button>

    <!-- Hiển thị kết quả -->
    <h3>Result:</h3>
    <pre id="result"></pre>

    <script>
        const gatewayUrl = "http://localhost:5261"; // đổi thành API Gateway của bạn

        async function submitCode() {
            let body = {
                SourceCode: document.getElementById("codeArea").value,
                LanguageID: parseInt(document.getElementById("languageSelect").value)
            };

            try {
                let res = await fetch(gatewayUrl + "/submit", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(body)
                });

                if (!res.ok) {
                    throw new Error("Submit failed, status " + res.status);
                }

                let data = await res.json();
                document.getElementById("result").innerText = JSON.stringify(data, null, 2);
            } catch (err) {
                document.getElementById("result").innerText = err.message;
            }
        }
    </script>
</body>
</html>
